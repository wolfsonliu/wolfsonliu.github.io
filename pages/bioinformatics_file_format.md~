Title: 生物信息文件
Date: 2018-07-16 15:36
Modified: 2018-07-16 15:36
Category: 壹零零壹
Tags: bioinformatics
Authors: Wolfson Liu
Summary: 常见生物信息文件解析.


## SAM/BAM ##

SAM （sequence alignment/map）文件是用于存储二代测序数据匹配结果的文本
文件格式。BAM文件是其二进制格式，比SAM文件要节约存储空间，两者可以容易
地进行转换。SAM文件中一般有两部分构成，可选的头部（header section），
记录匹配信息的匹配部（alignment section）。头部主要是存储一些和文件格
式规格，匹配软件，匹配参考基因组等相关的信息。而匹配部则是序列的具体匹
配信息，每条序列占据一行，每行包含多个列存储不同的内容。

### 示例 ###

假设存在下面的序列要存储为 SAM 文件。 ref 是参考基因组，而 r001 等是不
同的测序数据。

```
Coor     12345678901234  5678901234567890123456789012345
ref      AGCATGTTAGATAA**GATAGCTGTGCTAGTAGGCAGTCAGCGCCAT

+r001/1        TTAGATAAAGGATA*CTG
+r002         aaaAGATAA*GGATA
+r003       gcctaAGCTAA
+r004                     ATAGCT..............TCAGC
-r003                            ttagctTAGGC
-r001/2                                        CAGCGGCAT
```

那么其存为 SAM 文件应为：

```
@HD VN:1.6 SO:coordinate
@SQ SN:ref LN:45
r001   99 ref  7 30 8M2I4M1D3M = 37  39 TTAGATAAAGGATACTG *
r002    0 ref  9 30 3S6M1P1I4M *  0   0 AAAAGATAAGGATA    *
r003    0 ref  9 30 5S6M       *  0   0 GCCTAAGCTAA       * SA:Z:ref,29,-,6H5M,17,0;
r004    0 ref 16 30 6M14N5M    *  0   0 ATAGCTTCAGC       *
r003 2064 ref 29 17 6H5M       *  0   0 TAGGC             * SA:Z:ref,9,+,5S6M,30,1;
r001  147 ref 37 30 9M         =  7 -39 CAGCGGCAT         * NM:i:1
```

其中 `@HD` 和 `@SQ` 是头部，头部的行以 @ 起始。而文件中剩下的部分则是
匹配部，是具体的匹配信息。

### 头部 ###



#### Reference ####

* https://samtools.github.io/hts-specs/SAMv1.pdf
